% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_NAM.R
\name{create_NAM}
\alias{create_NAM}
\title{Create a Neighborhood Abundance Matrix (NAM) and Decompose it}
\usage{
create_NAM(
  metadata,
  pcs,
  samplem_key = NULL,
  graph_use = "RNA_snn",
  batches = NULL,
  covs = NULL,
  nsteps = NULL,
  verbose = TRUE,
  assay = NULL,
  key = "NAMPC_"
)
}
\arguments{
\item{metadata}{A data frame with cell-level metadata.}

\item{pcs}{A numeric matrix of principal components or other embeddings (cells x PCs).}

\item{samplem_key}{The column name in `metadata` that identifies the sample/individual.}

\item{graph_use}{The name of the graph in the Seurat object to use.}

\item{batches}{A character vector of batch variable names in `metadata`.}

\item{covs}{A character vector of other covariate names in `metadata`.}

\item{nsteps}{The number of diffusion steps. If NULL, it's determined automatically.}

\item{verbose}{Logical, if TRUE, print progress messages.}

\item{assay}{The assay name to use when creating the Seurat object.}

\item{key}{A prefix for the resulting DimReduc object.}
}
\value{
A list containing the SVD of the NAM: `sampleXpc` (sample loadings),
  `svs` (squared singular values), `nbhdXpc` (neighborhood loadings), and
  `varexp` (variance explained).
}
\description{
This function implements the core logic of the CNA method. It builds a
neighborhood graph, diffuses sample information across it to create a NAM,
performs quality control, residualizes covariates, and finally decomposes
the NAM using SVD to produce NAM PCs.
}
